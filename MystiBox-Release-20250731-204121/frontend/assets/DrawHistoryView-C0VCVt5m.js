import{I as k,d as j,r as m,g as H,c as s,a as t,m as V,F as x,i as y,x as S,l as I,C as L,t as i,p as C,e as A,o,_ as B}from"./index-o0ffgrYm.js";const U={async drawPet(d){console.log("发送抽卡请求:",d);const n=await k.post(`/draw/${d}`);return console.log("抽卡API响应:",n),n},async getDrawHistory(d=1,n=20){return await k.get("/draw/history",{params:{page:d,limit:n}})}},z={class:"container mx-auto px-4 py-8"},F={class:"max-w-4xl mx-auto"},P={key:0,class:"text-center py-16"},$={key:1,class:"space-y-4"},q={class:"flex items-center justify-between mb-4"},E={class:"flex items-center space-x-3"},M={class:"font-semibold text-neutral-text-primary"},T={class:"text-sm text-neutral-text-secondary"},G={class:"text-right"},J={class:"font-semibold text-accent-500"},K={class:"grid grid-cols-2 sm:grid-cols-3 md:grid-cols-5 gap-3"},O={class:"aspect-square rounded-lg overflow-hidden bg-gradient-to-br from-gray-100 to-gray-200 relative"},Q=["src","alt"],W={key:1,class:"w-full h-full flex items-center justify-center"},X={class:"mt-2 text-center"},Y={class:"text-sm font-medium text-neutral-text-primary truncate"},Z={class:"absolute inset-0 bg-black/80 rounded-lg opacity-0 group-hover:opacity-100 transition-opacity flex items-center justify-center"},tt={class:"text-center text-white p-2"},et={class:"font-semibold"},st={class:"text-xs opacity-80"},ot={key:2,class:"text-center py-16"},at={key:3,class:"mt-8 flex justify-center"},rt={class:"flex space-x-2"},nt=["onClick"],it=j({__name:"DrawHistoryView",setup(d){const n=m(!0),u=m([]),l=m({page:1,limit:20,total:0,pages:1}),g=async(c=1)=>{try{n.value=!0;const e=await U.getDrawHistory(c,l.value.limit);u.value=e.data||[],l.value=e.pagination||l.value}catch(e){console.error("加载抽取历史失败:",e),u.value=[]}finally{n.value=!1}},D=c=>new Date(c).toLocaleString("zh-CN",{year:"numeric",month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit"}),N=c=>{switch(c){case"UR":return"bg-gradient-to-r from-purple-500 to-pink-500";case"SSR":return"bg-gradient-to-r from-yellow-400 to-orange-500";case"SR":return"bg-gradient-to-r from-purple-400 to-blue-500";case"R":return"bg-gradient-to-r from-blue-400 to-cyan-500";case"N":return"bg-gray-500";default:return"bg-gray-500"}};return H(()=>{g()}),(c,e)=>{const R=L("RouterLink");return o(),s("div",z,[t("div",F,[e[8]||(e[8]=t("div",{class:"mb-8"},[t("h1",{class:"text-3xl font-bold text-neutral-text-primary mb-2"},"抽取历史"),t("p",{class:"text-neutral-text-secondary"},"查看您的所有抽取记录")],-1)),n.value?(o(),s("div",P,e[0]||(e[0]=[t("div",{class:"animate-spin rounded-full h-12 w-12 border-b-2 border-primary-500 mx-auto mb-4"},null,-1),t("p",{class:"text-neutral-text-secondary"},"加载中...",-1)]))):u.value.length>0?(o(),s("div",$,[(o(!0),s(x,null,y(u.value,a=>{var p;return o(),s("div",{key:a.id,class:"glass-card p-6 hover:bg-white/5 transition-colors"},[t("div",q,[t("div",E,[e[1]||(e[1]=t("div",{class:"w-10 h-10 bg-primary-500 rounded-lg flex items-center justify-center"},[t("span",{class:"text-white text-lg"},"🎲")],-1)),t("div",null,[t("h3",M,i(((p=a.series)==null?void 0:p.name)||"未知系列"),1),t("p",T,i(D(a.createdAt)),1)])]),t("div",G,[e[2]||(e[2]=t("p",{class:"text-sm text-neutral-text-secondary"},"消耗积分",-1)),t("p",J,i(a.cost),1)])]),t("div",K,[(o(!0),s(x,null,y(a.results||[],r=>{var _,b,v,f,h,w;return o(),s("div",{key:r.id,class:"relative group"},[t("div",O,[(_=r.pet)!=null&&_.babyImageUrl?(o(),s("img",{key:0,src:r.pet.babyImageUrl,alt:r.pet.name,class:"w-full h-full object-cover"},null,8,Q)):(o(),s("div",W,e[3]||(e[3]=[t("span",{class:"text-4xl"},"🐾",-1)]))),t("div",{class:C(["absolute top-1 right-1 px-2 py-1 rounded text-xs font-bold text-white",N((b=r.pet)==null?void 0:b.rarity)])},i(((v=r.pet)==null?void 0:v.rarity)||"N"),3)]),t("div",X,[t("p",Y,i(((f=r.pet)==null?void 0:f.name)||"未知宠物"),1)]),t("div",Z,[t("div",tt,[t("p",et,i((h=r.pet)==null?void 0:h.name),1),t("p",st,i((w=r.pet)==null?void 0:w.rarity),1)])])])}),128))])])}),128))])):(o(),s("div",ot,[e[5]||(e[5]=t("div",{class:"text-6xl mb-4"},"📜",-1)),e[6]||(e[6]=t("h3",{class:"text-xl font-semibold mb-2"},"暂无抽取记录",-1)),e[7]||(e[7]=t("p",{class:"text-neutral-text-secondary mb-4"},"您还没有进行过任何抽取，快去商店试试手气吧！",-1)),S(R,{to:"/store",class:"btn btn-primary"},{default:I(()=>e[4]||(e[4]=[A(" 前往商店 ",-1)])),_:1,__:[4]})])),l.value.pages>1?(o(),s("div",at,[t("div",rt,[(o(!0),s(x,null,y(l.value.pages,a=>(o(),s("button",{key:a,onClick:p=>g(a),class:C(["px-3 py-2 rounded-lg text-sm font-medium transition-colors",a===l.value.page?"bg-primary-500 text-white":"bg-white/10 text-neutral-text-secondary hover:bg-white/20"])},i(a),11,nt))),128))])])):V("",!0)])])}}}),ct=B(it,[["__scopeId","data-v-39246c98"]]);export{ct as default};
