<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>MystiBox - å® ç‰©ç›²ç›’</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        .glass-card {
            background: rgba(255, 255, 255, 0.1);
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255, 255, 255, 0.2);
        }
        .gradient-bg {
            background: linear-gradient(135deg, #87CEEB 0%, #FFDAB9 100%);
        }
    </style>
</head>
<body class="gradient-bg min-h-screen">
    <div id="app">
        <!-- å¯¼èˆªæ  -->
        <nav class="glass-card p-4 mb-8">
            <div class="container mx-auto flex justify-between items-center">
                <h1 class="text-2xl font-bold text-white">ğŸ MystiBox</h1>
                <div class="space-x-4">
                    <button onclick="showLogin()" class="bg-blue-500 text-white px-4 py-2 rounded hover:bg-blue-600">ç™»å½•</button>
                    <span id="userInfo" class="text-white hidden"></span>
                </div>
            </div>
        </nav>

        <!-- ä¸»è¦å†…å®¹ -->
        <div class="container mx-auto px-4">
            <!-- æ¬¢è¿åŒºåŸŸ -->
            <div class="text-center py-16 mb-12">
                <h1 class="text-5xl font-bold text-white mb-6">
                    æ¬¢è¿æ¥åˆ° <span class="text-yellow-300">MystiBox</span>
                </h1>
                <p class="text-xl text-white mb-8 max-w-2xl mx-auto">
                    æ¢ç´¢ç¥ç§˜çš„å® ç‰©ä¸–ç•Œï¼Œæ”¶é›†å¯çˆ±çš„ä¼™ä¼´ï¼Œä½“éªŒå……æ»¡æƒŠå–œçš„å¼€ç›’ä¹è¶£
                </p>
                <button onclick="showStore()" class="bg-yellow-500 text-white px-8 py-3 rounded-lg text-lg font-semibold hover:bg-yellow-600 transform hover:scale-105 transition-all">
                    ğŸ® å¼€å§‹æ¢ç´¢
                </button>
            </div>

            <!-- ç›²ç›’å•†åº— -->
            <div id="store" class="hidden">
                <h2 class="text-3xl font-bold text-white text-center mb-8">ğŸ›ï¸ ç›²ç›’å•†åº—</h2>
                <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6" id="seriesList">
                    <!-- ç³»åˆ—å¡ç‰‡å°†é€šè¿‡JavaScriptåŠ¨æ€ç”Ÿæˆ -->
                </div>
            </div>

            <!-- ç³»åˆ—è¯¦æƒ… -->
            <div id="seriesDetail" class="hidden">
                <div class="max-w-4xl mx-auto">
                    <button onclick="showStore()" class="mb-4 text-white hover:text-yellow-300">â† è¿”å›å•†åº—</button>
                    <div class="grid grid-cols-1 lg:grid-cols-2 gap-8">
                        <div class="aspect-square rounded-lg overflow-hidden">
                            <img id="seriesImage" class="w-full h-full object-cover" />
                        </div>
                        <div class="glass-card p-6">
                            <h1 id="seriesName" class="text-3xl font-bold text-white mb-4"></h1>
                            <p id="seriesDescription" class="text-white mb-6"></p>
                            
                            <div class="mb-6">
                                <div class="flex justify-between mb-2">
                                    <span class="text-white">ä»·æ ¼:</span>
                                    <span id="seriesPrice" class="font-bold text-yellow-300"></span>
                                </div>
                                <div class="flex justify-between mb-2">
                                    <span class="text-white">æˆ‘çš„ç§¯åˆ†:</span>
                                    <span id="userPoints" class="font-bold text-green-300">1000</span>
                                </div>
                            </div>
                            
                            <button id="drawButton" onclick="drawPet()" class="w-full bg-red-500 text-white py-3 px-6 rounded-lg text-lg font-semibold hover:bg-red-600 transform hover:scale-105 transition-all">
                                ğŸ² æŠ½å–ç›²ç›’
                            </button>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- ç™»å½•æ¨¡æ€æ¡† -->
        <div id="loginModal" class="fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 hidden">
            <div class="glass-card p-6 max-w-md w-full mx-4">
                <h2 class="text-2xl font-bold text-white text-center mb-6">ç™»å½•</h2>
                <div class="space-y-4">
                    <input id="username" type="text" placeholder="ç”¨æˆ·å" class="w-full px-4 py-2 rounded border" value="testuser">
                    <input id="password" type="password" placeholder="å¯†ç " class="w-full px-4 py-2 rounded border" value="test123456">
                    <button onclick="login()" class="w-full bg-blue-500 text-white py-2 rounded hover:bg-blue-600">ç™»å½•</button>
                    <button onclick="hideLogin()" class="w-full bg-gray-500 text-white py-2 rounded hover:bg-gray-600">å–æ¶ˆ</button>
                </div>
                <p class="text-sm text-white mt-4 text-center">æµ‹è¯•è´¦å·: testuser / test123456</p>
            </div>
        </div>

        <!-- æŠ½å–ç»“æœæ¨¡æ€æ¡† -->
        <div id="resultModal" class="fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 hidden">
            <div class="glass-card p-6 max-w-md w-full mx-4 text-center">
                <h2 class="text-2xl font-bold text-white mb-4">ğŸ‰ æ­å–œè·å¾—</h2>
                <div class="mb-4">
                    <img id="resultImage" class="w-32 h-32 mx-auto rounded-lg mb-4" />
                    <h3 id="resultName" class="text-xl font-bold text-white mb-2"></h3>
                    <p id="resultDescription" class="text-white text-sm mb-4"></p>
                    <div id="resultRarity" class="flex justify-center space-x-1 mb-4">
                        <!-- æ˜Ÿçº§æ˜¾ç¤º -->
                    </div>
                </div>
                <div class="space-y-2">
                    <button onclick="hideResult()" class="w-full bg-blue-500 text-white py-2 rounded hover:bg-blue-600">ç»§ç»­æŠ½å–</button>
                    <p class="text-sm text-white">å‰©ä½™ç§¯åˆ†: <span id="remainingPoints"></span></p>
                </div>
            </div>
        </div>
    </div>

    <script>
        // å…¨å±€çŠ¶æ€
        let currentUser = null;
        let currentSeries = null;
        
        // æ¨¡æ‹Ÿæ•°æ®
        const mockSeries = [
            {
                id: 1,
                name: 'æ£®æ—ç²¾çµç³»åˆ—',
                description: 'æ¥è‡ªç¥ç§˜æ£®æ—çš„å¯çˆ±ç²¾çµä»¬ï¼Œæ¯ä¸€åªéƒ½æ‹¥æœ‰ç‹¬ç‰¹çš„é­”æ³•èƒ½åŠ›',
                image: 'https://images.unsplash.com/photo-1441974231531-c6227db76b6e?w=400&h=400&fit=crop',
                price: 100,
                pets: [
                    { id: '1', name: 'å°ç²¾çµ', rarity: 1, description: 'æ¥è‡ªæ£®æ—çš„å°ç²¾çµ', image: 'https://images.unsplash.com/photo-1578662996442-48f60103fc96?w=300&h=300&fit=crop' },
                    { id: '2', name: 'æ£®æ—å®ˆæŠ¤è€…', rarity: 2, description: 'å®ˆæŠ¤æ£®æ—çš„ç²¾çµ', image: 'https://images.unsplash.com/photo-1578662996442-48f60103fc96?w=300&h=300&fit=crop' },
                    { id: '3', name: 'å¤æ ‘ä¹‹çµ', rarity: 3, description: 'åƒå¹´å¤æ ‘çš„çµé­‚', image: 'https://images.unsplash.com/photo-1578662996442-48f60103fc96?w=300&h=300&fit=crop' },
                    { id: '4', name: 'æ£®æ—å¥³ç‹', rarity: 4, description: 'æ£®æ—çš„ç»Ÿæ²»è€…', image: 'https://images.unsplash.com/photo-1578662996442-48f60103fc96?w=300&h=300&fit=crop' }
                ]
            },
            {
                id: 2,
                name: 'æµ·æ´‹å†’é™©ç³»åˆ—',
                description: 'æ·±æµ·ä¸­çš„å¥‡å¦™ç”Ÿç‰©ï¼Œå¸¦ä½ æ¢ç´¢æœªçŸ¥çš„æµ·åº•ä¸–ç•Œ',
                image: 'https://images.unsplash.com/photo-1559827260-dc66d52bef19?w=400&h=400&fit=crop',
                price: 120,
                pets: [
                    { id: '5', name: 'å°æµ·æ˜Ÿ', rarity: 1, description: 'å¯çˆ±çš„å°æµ·æ˜Ÿ', image: 'https://images.unsplash.com/photo-1583212292454-1fe6229603b7?w=300&h=300&fit=crop' },
                    { id: '6', name: 'çŠç‘šç²¾çµ', rarity: 2, description: 'çŠç‘šç¤çš„å®ˆæŠ¤è€…', image: 'https://images.unsplash.com/photo-1583212292454-1fe6229603b7?w=300&h=300&fit=crop' },
                    { id: '7', name: 'æ·±æµ·å·¨å…½', rarity: 3, description: 'æ·±æµ·çš„ç¥ç§˜ç”Ÿç‰©', image: 'https://images.unsplash.com/photo-1583212292454-1fe6229603b7?w=300&h=300&fit=crop' },
                    { id: '8', name: 'æµ·æ´‹ä¹‹ç‹', rarity: 4, description: 'ç»Ÿæ²»æµ·æ´‹çš„ç‹è€…', image: 'https://images.unsplash.com/photo-1583212292454-1fe6229603b7?w=300&h=300&fit=crop' }
                ]
            },
            {
                id: 3,
                name: 'æ˜Ÿç©ºå®ˆæŠ¤ç³»åˆ—',
                description: 'æ¥è‡ªæ˜Ÿç©ºçš„ç¥ç§˜å®ˆæŠ¤è€…ï¼Œå®ˆæŠ¤ç€å®‡å®™çš„ç§˜å¯†',
                image: 'https://images.unsplash.com/photo-1446776877081-d282a0f896e2?w=400&h=400&fit=crop',
                price: 150,
                pets: [
                    { id: '9', name: 'å°æ˜Ÿæ˜Ÿ', rarity: 1, description: 'é—ªé—ªå‘å…‰çš„å°æ˜Ÿæ˜Ÿ', image: 'https://images.unsplash.com/photo-1446776877081-d282a0f896e2?w=300&h=300&fit=crop' },
                    { id: '10', name: 'æœˆäº®ç²¾çµ', rarity: 2, description: 'æœˆå…‰ä¸‹çš„ç²¾çµ', image: 'https://images.unsplash.com/photo-1446776877081-d282a0f896e2?w=300&h=300&fit=crop' },
                    { id: '11', name: 'æ˜Ÿåº§å®ˆæŠ¤è€…', rarity: 3, description: 'å®ˆæŠ¤æ˜Ÿåº§çš„ä½¿è€…', image: 'https://images.unsplash.com/photo-1446776877081-d282a0f896e2?w=300&h=300&fit=crop' },
                    { id: '12', name: 'å®‡å®™ä¹‹ç¥', rarity: 5, description: 'åˆ›é€ å®‡å®™çš„ç¥æ˜', image: 'https://images.unsplash.com/photo-1446776877081-d282a0f896e2?w=300&h=300&fit=crop' }
                ]
            }
        ];

        // æ˜¾ç¤º/éšè—åŠŸèƒ½
        function showLogin() {
            document.getElementById('loginModal').classList.remove('hidden');
        }

        function hideLogin() {
            document.getElementById('loginModal').classList.add('hidden');
        }

        function showStore() {
            document.getElementById('store').classList.remove('hidden');
            document.getElementById('seriesDetail').classList.add('hidden');
            renderSeries();
        }

        function showSeriesDetail(seriesId) {
            currentSeries = mockSeries.find(s => s.id === seriesId);
            if (!currentSeries) return;

            document.getElementById('store').classList.add('hidden');
            document.getElementById('seriesDetail').classList.remove('hidden');
            
            document.getElementById('seriesImage').src = currentSeries.image;
            document.getElementById('seriesName').textContent = currentSeries.name;
            document.getElementById('seriesDescription').textContent = currentSeries.description;
            document.getElementById('seriesPrice').textContent = currentSeries.price + ' ç§¯åˆ†';
            
            updateDrawButton();
        }

        function hideResult() {
            document.getElementById('resultModal').classList.add('hidden');
        }

        // ç™»å½•åŠŸèƒ½
        function login() {
            const username = document.getElementById('username').value;
            const password = document.getElementById('password').value;
            
            if ((username === 'testuser' && password === 'test123456') || 
                (username === 'demo' && password === 'demo123')) {
                currentUser = {
                    username: username,
                    points: 1000
                };
                
                document.getElementById('userInfo').textContent = `${username} (${currentUser.points}ç§¯åˆ†)`;
                document.getElementById('userInfo').classList.remove('hidden');
                document.querySelector('button[onclick="showLogin()"]').classList.add('hidden');
                
                hideLogin();
                updateDrawButton();
                alert('ç™»å½•æˆåŠŸï¼');
            } else {
                alert('ç”¨æˆ·åæˆ–å¯†ç é”™è¯¯');
            }
        }

        // æ¸²æŸ“ç³»åˆ—åˆ—è¡¨
        function renderSeries() {
            const container = document.getElementById('seriesList');
            container.innerHTML = mockSeries.map(series => `
                <div class="glass-card p-6 cursor-pointer hover:scale-105 transition-transform" onclick="showSeriesDetail(${series.id})">
                    <img src="${series.image}" alt="${series.name}" class="w-full h-48 object-cover rounded-lg mb-4">
                    <h3 class="text-xl font-bold text-white mb-2">${series.name}</h3>
                    <p class="text-white text-sm mb-4">${series.description}</p>
                    <div class="flex justify-between items-center">
                        <span class="text-yellow-300 font-bold">${series.price} ç§¯åˆ†</span>
                        <span class="text-white text-sm">${series.pets.length} åªå® ç‰©</span>
                    </div>
                </div>
            `).join('');
        }

        // æ›´æ–°æŠ½å–æŒ‰é’®çŠ¶æ€
        function updateDrawButton() {
            const button = document.getElementById('drawButton');
            const pointsSpan = document.getElementById('userPoints');
            
            if (currentUser) {
                pointsSpan.textContent = currentUser.points;
                if (currentSeries && currentUser.points >= currentSeries.price) {
                    button.disabled = false;
                    button.textContent = `ğŸ² æŠ½å–ç›²ç›’ (${currentSeries.price} ç§¯åˆ†)`;
                    button.className = 'w-full bg-red-500 text-white py-3 px-6 rounded-lg text-lg font-semibold hover:bg-red-600 transform hover:scale-105 transition-all';
                } else {
                    button.disabled = true;
                    button.textContent = 'ç§¯åˆ†ä¸è¶³';
                    button.className = 'w-full bg-gray-500 text-white py-3 px-6 rounded-lg text-lg font-semibold cursor-not-allowed';
                }
            } else {
                pointsSpan.textContent = 'æœªç™»å½•';
                button.disabled = true;
                button.textContent = 'è¯·å…ˆç™»å½•';
                button.className = 'w-full bg-gray-500 text-white py-3 px-6 rounded-lg text-lg font-semibold cursor-not-allowed';
            }
        }

        // æŠ½å–å® ç‰©
        function drawPet() {
            if (!currentUser || !currentSeries || currentUser.points < currentSeries.price) {
                alert('æ— æ³•æŠ½å–');
                return;
            }

            // ç¨€æœ‰åº¦æƒé‡
            const rarityWeights = { 1: 50, 2: 30, 3: 15, 4: 4, 5: 1 };
            const random = Math.random() * 100;
            let targetRarity = 1;
            let cumulative = 0;

            for (const [rarity, weight] of Object.entries(rarityWeights)) {
                cumulative += weight;
                if (random <= cumulative) {
                    targetRarity = parseInt(rarity);
                    break;
                }
            }

            // é€‰æ‹©å® ç‰©
            const availablePets = currentSeries.pets.filter(p => p.rarity === targetRarity);
            const finalPets = availablePets.length > 0 ? availablePets : currentSeries.pets.filter(p => p.rarity === 1);
            const pet = finalPets[Math.floor(Math.random() * finalPets.length)];

            // æ‰£é™¤ç§¯åˆ†
            currentUser.points -= currentSeries.price;

            // æ˜¾ç¤ºç»“æœ
            document.getElementById('resultImage').src = pet.image;
            document.getElementById('resultName').textContent = pet.name;
            document.getElementById('resultDescription').textContent = pet.description;
            document.getElementById('remainingPoints').textContent = currentUser.points;
            
            // æ˜¾ç¤ºæ˜Ÿçº§
            const rarityContainer = document.getElementById('resultRarity');
            rarityContainer.innerHTML = '';
            for (let i = 1; i <= 5; i++) {
                const star = document.createElement('div');
                star.className = `w-4 h-4 rounded-full ${i <= pet.rarity ? 'bg-yellow-400' : 'bg-gray-400'}`;
                rarityContainer.appendChild(star);
            }

            document.getElementById('resultModal').classList.remove('hidden');
            updateDrawButton();
        }

        // åˆå§‹åŒ–
        document.addEventListener('DOMContentLoaded', function() {
            renderSeries();
        });
    </script>
</body>
</html>
